(this["webpackJsonptest-link"]=this["webpackJsonptest-link"]||[]).push([[0],{15:function(e,n,t){e.exports={main:"Main_main__3de2d",inputContainer:"Main_inputContainer__35VOy",inputContainerText:"Main_inputContainerText__P3SPV",inputButton:"Main_inputButton__30NvA",uploadImageContainer:"Main_uploadImageContainer__2-OV5",uploadImage:"Main_uploadImage__3UDpu",uploadImageSvg:"Main_uploadImageSvg__3Bl80",loadingSvg:"Main_loadingSvg__3Lonw",rotate:"Main_rotate__fUcs_",loading:"Main_loading__1-56n",enbigger:"Main_enbigger__Z3RkF",blurEffect:"Main_blurEffect__3jrdr",h1Container:"Main_h1Container__2GtL-",rotation:"Main_rotation__1jzl2",topBar:"Main_topBar__2kkWe",logOut:"Main_logOut__zT7Ja",menuContainer:"Main_menuContainer__2znkv",menuContainerOpen:"Main_menuContainerOpen__2NfKL",menuCloseButton:"Main_menuCloseButton__RIzsQ",menuList:"Main_menuList__3YNmC",menuItem:"Main_menuItem__3mXI_",flexContainer:"Main_flexContainer__2QlCf",flexTop:"Main_flexTop__37RFt",flexBottom:"Main_flexBottom__1Y8lE",welcomeContainer:"Main_welcomeContainer__2rSMK"}},20:function(e,n,t){e.exports={container:"Input_container__16MGs",input:"Input_input__24dvw",label:"Input_label__3-Wil",containerActive:"Input_containerActive__NKmK5"}},24:function(e,n,t){e.exports={message:"Links_message__SKLEX",heightAnim:"Links_heightAnim__3DO1x",appear:"Links_appear__3MU0v",image:"Links_image__4rLoB",urlMessage:"Links_urlMessage__2SEs9",textMessage:"Links_textMessage__2QzVe"}},28:function(e,n,t){e.exports={logIn:"Login_logIn__3Av5G",topBar:"Login_topBar__2FKYl",buttonContainer:"Login_buttonContainer___HDtm",errorContainer:"Login_errorContainer__3Rfne",appearFromBottom:"Login_appearFromBottom__25jzz"}},32:function(e,n,t){e.exports={contextMenu:"ContextMenu_contextMenu__3qmsv",contextMenuHidden:"ContextMenu_contextMenuHidden__2YEnK",item:"ContextMenu_item__2ziTi"}},52:function(e,n,t){e.exports={container:"App_container__1MQN3"}},54:function(e,n,t){e.exports={container:"register_container__23q2a"}},59:function(e,n,t){},80:function(e,n,t){"use strict";t.r(n);var a=t(3),c=t.n(a),i=t(50),o=t.n(i),r=(t(59),t(51)),s=(Object(r.a)({apiKey:"AIzaSyB_baY-4hwFfFedYOnYV-8NHjCrvRbFuIE",authDomain:"mssn-lnk.firebaseapp.com",projectId:"mssn-lnk",storageBucket:"mssn-lnk.appspot.com",messagingSenderId:"955405464456",appId:"1:955405464456:web:6ee9b6ffa058ea3aab403d"}),t(52)),u=t.n(s),l=t(10),d=t(20),j=t.n(d),b=t(5);function m(e){var n=e.label,t=e.id,c=e.value,i=e.onChange,o=e.type,r=e.onKeyPress,s=Object(a.useState)(!1),u=Object(l.a)(s,2),d=u[0],m=u[1];return Object(b.jsxs)("div",{className:d?"".concat(j.a.container," ").concat(j.a.containerActive):j.a.container,children:[void 0!==n&&Object(b.jsx)("label",{className:j.a.label,htmlFor:t,children:n}),Object(b.jsx)("input",{onKeyPress:r,onChange:i,value:c,onFocus:function(){m(!0)},onBlur:function(){""===c&&m(!1)},id:t,className:j.a.input,type:o})]})}function f(e){var n=e.label,t=e.id,c=e.value,i=e.onChange,o=Object(a.useState)(!1),r=Object(l.a)(o,2),s=r[0],u=r[1];return Object(b.jsxs)("div",{className:s?"".concat(j.a.container," ").concat(j.a.containerActive):j.a.container,children:[Object(b.jsx)("label",{className:j.a.label,htmlFor:t,children:n}),Object(b.jsx)("input",{onChange:i,value:c,onFocus:function(){u(!0)},onBlur:function(){""===c&&u(!1)},id:t,className:j.a.input,type:"password"})]})}var p=t(28),O=t.n(p),h=t(19),x=t(0),v=t(1),g=t(53),_=t.n(g);function w(){return new Promise((function(e,n){var t=Object(h.a)(),a=Object(h.c)(t,function(){var t=Object(v.a)(Object(x.a)().mark((function t(c){var i,o;return Object(x.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a(),!c){t.next=9;break}return t.next=4,c.getIdToken(!0);case 4:i=t.sent,o=_.a.create({headers:{Authorization:"Bearer ".concat(i)}}),e(o),t.next=10;break;case 9:n();case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[])}))}function C(){return k.apply(this,arguments)}function k(){return(k=Object(v.a)(Object(x.a)().mark((function e(){var n,t;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:return n=e.sent,e.next=5,n.get("/api/getuser");case 5:return t=e.sent,e.abrupt("return",t.data.user);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(v.a)(Object(x.a)().mark((function e(n){var t,a;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:return t=e.sent,e.next=5,t.post("/api/user",n);case 5:return a=e.sent,e.abrupt("return",a.data);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(v.a)(Object(x.a)().mark((function e(n){var t,a,c;return Object(x.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:return t=e.sent,(a=new FormData).append("file",n),e.next=7,t.post("/api/upload-file",a);case 7:return c=e.sent,e.abrupt("return",c.data);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){var e=Object(a.useState)({username:"",password:""}),n=Object(l.a)(e,2),t=n[0],c=n[1],i=Object(a.useState)(!1),o=Object(l.a)(i,2),r=o[0],s=o[1];return Object(a.useEffect)((function(){C().then((function(){window.location.href="/"})).catch((function(){}))})),Object(b.jsxs)("div",{className:O.a.logIn,children:[Object(b.jsx)("div",{className:O.a.topBar,children:Object(b.jsx)("h1",{children:"Lnk"})}),Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=t.username,a=t.password,i=Object(h.a)();Object(h.d)(i,n,a).then((function(){window.location.href="/"})).catch((function(e){console.error(e),s(!0),setTimeout((function(){s(!1)}),4e3)})),c({username:"",password:""})},children:[Object(b.jsx)(m,{onChange:function(e){c((function(n){return{username:e.target.value,password:n.password}}))},id:"username",value:t.username,label:"Email",type:"email"}),Object(b.jsx)(f,{onChange:function(e){c((function(n){return{username:n.username,password:e.target.value}}))},id:"password",value:t.password,label:"Password"}),Object(b.jsx)("div",{className:O.a.buttonContainer,children:Object(b.jsx)("button",{type:"submit",children:"Log in"})})]}),r&&Object(b.jsx)("div",{className:r?O.a.errorContainer:"",children:"Wrong email or password :("})]})}var L=t(23),S=t(14),I="wsid";function B(){return Object(a.useMemo)((function(){if("undefined"===typeof window)return"";var e=window.localStorage.getItem(I);if(e)return e;var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";return Object(S.a)(Array(e)).map((function(){return Math.floor(Math.random()*n.length)})).map((function(e){return n.charAt(e)})).join("")}();return window.localStorage.setItem(I,n),n}),[])}var E=t(9),F=t(15),A=t.n(F);var T=t(24),Y=t.n(T);function z(e){var n,t=e.content,a=e.openContextMenu,c=[{label:"Copy image URL",fn:function(){navigator.clipboard.writeText(t)}},{label:"Open in new tab",fn:function(){window.open(t)}}];return Object(b.jsx)("div",{onContextMenu:function(e){e.preventDefault();var n=e.clientX||0,t=e.clientY||0;a(n,t,c)},className:"".concat(Y.a.message," ").concat(Y.a.textMessage),children:Object(b.jsx)("img",{className:Y.a.image,src:(n=t,"https://lnk.mssnapps.com/api/image-proxy?img=".concat(n,"&width=600")),alt:"image sent by lnk"})})}function K(e){var n=e.content,t=e.openContextMenu,a=[{label:"Copy",fn:function(){navigator.clipboard.writeText(n)}}];return Object(b.jsx)("div",{onContextMenu:function(e){e.preventDefault();var n=e.clientX,c=e.clientY;t(n,c,a)},className:"".concat(Y.a.textMessage," ").concat(Y.a.message),children:Object(b.jsx)("span",{children:n})})}function R(e){var n=e.content,t=e.openContextMenu,a=[{label:"Go to URL",fn:function(){window.open(n,"_blank")}},{label:"Copy URL",fn:function(){navigator.clipboard.writeText(n)}}];return Object(b.jsx)("div",{onContextMenu:function(e){e.preventDefault();var n=e.clientX,c=e.clientY;t(n,c,a)},onClick:function(){return e=n,void(window.electron?window.electron.openURL(e):window.open(e));var e},className:"".concat(Y.a.message," ").concat(Y.a.urlMessage),children:Object(b.jsx)("span",{children:n})})}var D=function(e){var n=e.links,t=e.openContextMenu,a=function(e){switch(e.type){case"url":return Object(b.jsx)(R,{openContextMenu:t,content:e.message});case"img":return Object(b.jsx)(z,{openContextMenu:t,content:e.message});default:return Object(b.jsx)(K,{openContextMenu:t,content:e.message})}},c=n.map((function(e){return Object(b.jsx)("div",{children:a(e)},e.uid)}));return Object(b.jsx)("div",{className:Y.a.linksContainer,children:c})},P=t(32),J=t.n(P);var W=function(e){var n=e.context;return Object(b.jsx)("div",{style:{left:"".concat(n.x,"px"),top:"".concat(n.y,"px")},className:n.visible?J.a.contextMenu:"".concat(J.a.contextMenu," ").concat(J.a.contextMenuHidden),children:n.items.map((function(e){return Object(b.jsx)("div",{className:J.a.item,onClick:function(){return e.fn()},children:Object(b.jsx)("span",{children:e.label})},e.label)}))})},U="wss://lnk.mssnapps.com/ws";function V(){var e=B(),n=Object(a.useState)({email:"",firstname:"",id:0,key:"",lastname:"",username:""}),t=Object(l.a)(n,2),c=t[0],i=t[1],o=Object(a.useState)([]),r=Object(l.a)(o,2),s=r[0],u=r[1],d=Object(a.useState)(null),j=Object(l.a)(d,2),f=j[0],p=j[1],O=Object(a.useState)(!1),x=Object(l.a)(O,2),v=x[0],g=x[1],_=Object(a.useState)(""),w=Object(l.a)(_,2),k=w[0],M=w[1],y=Object(a.useState)(!1),S=Object(l.a)(y,2),I=S[0],F=S[1],T=Object(a.useState)(!1),Y=Object(l.a)(T,2),z=Y[0],K=Y[1],R=Object(a.useState)(!1),P=Object(l.a)(R,2),J=P[0],V=P[1],H=Object(E.l)(),X=null,G=Object(a.useState)({x:0,y:0,visible:!1,items:[]}),Q=Object(l.a)(G,2),q=Q[0],Z=Q[1];Object(a.useEffect)((function(){window.electron&&(window.electron.getIsNotificationActive().then((function(e){F(e)})),window.electron.getIsOpenLnk().then((function(e){K(e)})))}),[]);var $=Object(a.useState)(!1),ee=Object(l.a)($,2),ne=ee[0],te=ee[1],ae=function(n){var t="";if(n)t=JSON.stringify({code:"message",id:c.key,message:n,sender:e});else{if(""===k)return;t=JSON.stringify({code:"message",id:c.key,message:k,sender:e}),M("")}f.send(t)};Object(a.useEffect)((function(){C().then((function(e){null===e?H("/register"):(i(e),p(new WebSocket(U)),window.electron&&window.electron.sendId(e))})).catch((function(e){console.error(e),H("/login")}))}),[H]),Object(a.useEffect)((function(){""!==c.key&&null!==f&&(f.addEventListener("message",(function(e){var n=JSON.parse(e.data);"message"===n.code&&u(n.content),"success"===n.code&&u(n.content)})),f.addEventListener("open",(function(){g(!0);var n=JSON.stringify({code:"init",id:c.key,message:"",sender:e});f.send(n)})),f.addEventListener("close",(function(){p(new WebSocket(U))})),f.addEventListener("error",(function(){g(!1),p(null)})))}),[f,c]);return Object(b.jsxs)("div",{onClick:function(){Z((function(e){return Object(L.a)(Object(L.a)({},e),{},{visible:!1})}))},ref:function(e){return X=e},className:A.a.main,children:[!v&&Object(b.jsx)("div",{className:A.a.loading,children:Object(b.jsx)("div",{className:A.a.h1Container,children:Object(b.jsx)("h1",{children:"Lnk"})})}),Object(b.jsxs)("div",{className:ne?"".concat(A.a.menuContainer," ").concat(A.a.menuContainerOpen):A.a.menuContainer,children:[Object(b.jsx)("button",{className:A.a.menuCloseButton,onClick:function(){return te(!1)},children:Object(b.jsx)("svg",{"aria-hidden":"false",width:"12",height:"12",viewBox:"0 0 12 12",children:Object(b.jsx)("polygon",{fill:"currentColor",fillRule:"evenodd",points:"11 1.576 6.583 6 11 10.424 10.424 11 6 6.583 1.576 11 1 10.424 5.417 6 1 1.576 1.576 1 6 5.417 10.424 1"})})}),Object(b.jsxs)("ul",{className:A.a.menuList,children:[window.electron&&Object(b.jsxs)("li",{className:A.a.menuItem,children:[Object(b.jsx)("label",{htmlFor:"isNotCheck",children:"Notifications"}),Object(b.jsx)("input",{id:"isNotCheck",onChange:function(e){window.electron&&window.electron.setIsNotificationActive(e.target.checked).then((function(e){F(e)})).catch((function(e){console.error("Error communicating with Electron",e)}))},checked:I,type:"checkbox"})]}),window.electron&&Object(b.jsxs)("li",{className:A.a.menuItem,children:[Object(b.jsx)("label",{htmlFor:"openLnk",children:"Open "}),Object(b.jsx)("input",{id:"openLnk",onChange:function(e){window.electron&&window.electron.setIsOpenLnk(e.target.checked).then((function(e){K(e)})).catch((function(e){console.error("Error communicating with electron",e)}))},checked:z,type:"checkbox"})]}),Object(b.jsx)("li",{onClick:function(){return function(){var e=Object(h.a)();Object(h.e)(e).then((function(){window.location.href="/login"})).catch(console.error)}()},className:A.a.menuItem,children:"Log out"}),Object(b.jsx)("li",{onClick:function(){c.key&&confirm("Are you sure you want to delete the messages?")&&(null===f||void 0===f||f.send(JSON.stringify({code:"clear",message:"clear",id:c.key,sender:e})),te(!1))},className:A.a.menuItem,children:"Clear messages"})]})]}),Object(b.jsxs)("div",{className:A.a.flexContainer,children:[Object(b.jsxs)("div",{className:A.a.flexTop,children:[Object(b.jsxs)("div",{className:A.a.topBar,children:[Object(b.jsx)("h1",{children:"Lnk"}),Object(b.jsx)("button",{className:A.a.logOut,onClick:function(){return te(!0)},children:"Menu"})]}),Object(b.jsx)("div",{className:A.a.welcomeContainer,children:Object(b.jsxs)("span",{children:["Welcome ",c.username,"!"]})}),Object(b.jsxs)("div",{className:A.a.inputContainer,children:[Object(b.jsx)("div",{className:A.a.inputContainerText,children:Object(b.jsx)(m,{onKeyPress:function(e){"Enter"===e.code&&ae()},onChange:function(e){M(e.target.value)},value:k,type:"text"})}),Object(b.jsx)("button",{disabled:""===k,className:A.a.inputButton,onClick:function(){return ae()},children:"Send"}),Object(b.jsxs)("div",{className:A.a.uploadImageContainer,children:[Object(b.jsx)("label",{className:A.a.uploadImage,htmlFor:"image-upload",children:J?Object(b.jsxs)("svg",{className:A.a.loadingSvg,xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[Object(b.jsx)("path",{d:"M22 12c0 6-4.39 10-9.806 10C7.792 22 4.24 19.665 3 16"}),Object(b.jsx)("path",{d:"M2 12C2 6 6.39 2 11.806 2 16.209 2 19.76 4.335 21 8"}),Object(b.jsx)("path",{d:"M7 17l-4-1-1 4"}),Object(b.jsx)("path",{d:"M17 7l4 1 1-4"})]}):Object(b.jsxs)("svg",{className:A.a.uploadImageSvg,xmlns:"http://www.w3.org/2000/svg",width:"30",height:"30",viewBox:"0 0 24 24",fill:"none",stroke:"#dddbdb",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[Object(b.jsx)("path",{d:"M2 6a4 4 0 0 1 4-4h12a4 4 0 0 1 4 4v12a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V6z"}),Object(b.jsx)("circle",{cx:"8.5",cy:"8.5",r:"2.5"}),Object(b.jsx)("path",{d:"M14.526 12.621L6 22h12.133A3.867 3.867 0 0 0 22 18.133V18c0-.466-.175-.645-.49-.99l-4.03-4.395a2 2 0 0 0-2.954.006z"})]})}),Object(b.jsx)("input",{disabled:J,onChange:function(e){var n=e.target.files[0];n&&(V(!0),function(e){return N.apply(this,arguments)}(n).then((function(e){var n=e.url;ae(n)})).finally((function(){V(!1),e.target.value=null})))},style:{display:"none"},type:"file",id:"image-upload",name:"image",accept:"*/*"})]})]})]}),Object(b.jsx)("div",{className:A.a.flexBottom,children:Object(b.jsx)(D,{openContextMenu:function(e,n,t){var a,c=null===(a=X)||void 0===a?void 0:a.getBoundingClientRect(),i=e-c.x,o=n-c.y;Z({x:i,y:o,visible:!0,items:t})},links:s})})]}),Object(b.jsx)(W,{context:q})]})}var H=t(2),X=t(54),G=t.n(X),Q=4e3;function q(){var e=Object(a.useState)({firstname:"",lastname:"",nickname:""}),n=Object(l.a)(e,2),t=n[0],c=n[1],i=Object(a.useState)(""),o=Object(l.a)(i,2),r=o[0],s=o[1],u=function(e){setTimeout((function(){return s("")}),Q),s(e)},d=Object(E.l)(),j=function(e){return function(n){return c((function(t){return Object(L.a)(Object(L.a)({},t),{},Object(H.a)({},e,n.target.value))}))}};Object(a.useEffect)((function(){C().then((function(e){e&&d("/")})).catch((function(){d("/login")}))}),[]);return Object(b.jsxs)("div",{className:G.a.container,children:[Object(b.jsx)("h1",{children:"Lnk"}),Object(b.jsx)("p",{children:"Enter your information to start using LNK."}),Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n=t.firstname,a=t.lastname,c=t.nickname;return n?a?c?void(c.includes(" ")?u("Your nickname can't have spaces"):function(e){return M.apply(this,arguments)}(t).then((function(){d("/")})).catch((function(e){u(e.toString())}))):u("You have to enter your nickname"):u("You have to enter your lastname"):u("You have to enter your firstname")},children:[Object(b.jsx)(m,{onChange:j("firstname"),value:t.firstname,label:"Firstname",id:"firstname"}),Object(b.jsx)(m,{onChange:j("lastname"),value:t.lastname,label:"Lastname",id:"lastname"}),Object(b.jsx)(m,{onChange:j("nickname"),value:t.nickname,label:"Nickname",id:"nickname"}),Object(b.jsx)("div",{className:O.a.buttonContainer,children:Object(b.jsx)("button",{type:"submit",children:"Register"})}),r&&Object(b.jsx)("p",{className:O.a.errorContainer,children:r})]})]})}var Z=t(33),$=Object(a.createContext)({});function ee(e){var n=e.children,t=Object(a.useState)(),c=Object(l.a)(t,2),i=c[0],o=c[1];return Object(a.useEffect)((function(){var e=Object(h.a)(),n=Object(h.b)(e,(function(e){o(e||null)}));return function(){n()}}),[]),Object(b.jsx)($.Provider,{value:{user:i},children:n})}var ne=Object(Z.a)([{path:"/",element:Object(b.jsx)(V,{})},{path:"/login",element:Object(b.jsx)(y,{})},{path:"/register",element:Object(b.jsx)(q,{})}]);function te(){return Object(b.jsx)("div",{className:u.a.container,children:Object(b.jsx)(E.b,{router:ne})})}function ae(){return Object(b.jsx)(ee,{children:Object(b.jsx)(te,{})})}var ce=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,81)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,i=n.getLCP,o=n.getTTFB;t(e),a(e),c(e),i(e),o(e)}))};o.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(ae,{})}),document.getElementById("root")),ce()}},[[80,1,2]]]);